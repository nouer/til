# shell関係
## 環境変数
### 設定
  - `export aaa=1`

### 削除
  - `unset aaa`  
  - `export -n aaa`  
    `export aaa=""` などでは削除はできない  
    変数名前には `$` はつけない

### 取得
  - `env`

## コマンド
### ls
 - ファイル名のみリスト  
   `ls -1`
 - 再帰  
   `ls -R`
 - カンマ区切りで表示  
   `ls -m`
 - 容量表示  
   `ls -s`
 - 読みやすい単位で容量表示  
   `ls -sh`
 - パターンにマッチする対象は表示しない  
   `ls -I *dummy*`

### find
 - ファイル名のみ
   `find -type f`

### 変数
 - ハイフンは変数名に使えない
 - 先頭に数字は使えない
 - 変数作成時の＝の前後にスペースを入れることはできない（左辺をコマンドとして、＝と右辺を引数として実行しようとする）
 - スペースやタブを含む場合は''または""で囲む
 - 変数の参照には$を利用する
 - 代入時には$をつけないことに注意
 - 文字列と結合する場合は、{}で明示する  
   `item=pen`  
   `echo I have ${item}s`

### 環境変数
  - 現在のシェルからコマンドへ引き継がれる変数
  - 環境変数は子プロセスから参照できる
  - 現在の設定されている環境変数は `printenv` で確認できる
  - 環境変数の設定はexportコマンドを利用する  
    例1：
    `CONFIG_NAME=private_config`  
    `export CONFIG_NAME`  
    例2：  
    `export CONFIG_NAME=private_config`
  - コマンドの前に変数への代入を指定すると、その1回のプロセスだけで有効な環境変数になる  
    `CONFIG_NAME=private_config ./test.sh`
  - 特殊なシェル変数
    - HOME  
      ホームディレクトリ
    - PWD  
      カレントディレクトリ
    - SHELL  
      ログインシェル
    - BASH  
      bashコマンドのフルパス
    - BASH_VERSION  
      bashコマンドのバージョン
    - LINENO  
      現在実行しているシェルスクリプトの行番号
    - LANG  
      ローケル
    - PATH
      シェルがコマンドを探すディレクトリ
    - IFS
      シェルの区切り文字

### ファイルを開いているプロセス、ポートを開いているプロセスを表示
  - ファイルを開いているプロセスを表示（ディレクトリも指定可能）  
    `lsof [ファイル|ディレクトリ名]`
  - ディレクトリ以下再帰的に開いているプロセスを表示  
    `lsof +D [ディレクトリ名]`
  - tcpを開いているプロセスを表示  
    `lsof -i tcp`  
  - udpを開いているプロセスを表示
    `lsof -i udp`
  - ポートを開いているプロセスを表示（複数指定可能）  
    `lsof -i:[ポート番号]`  
    `lsof -i:[ポート番号1,ポート番号2]`
  - ポートを開いている（LISTEN）しているプロセスを表示  
    `lsof -i:[ポート番号] | grep LISTEN`
  - コマンド名(プロセス名)を指定して、開いているファイル・ポートを表示（複数指定可能）  
    `lsof -c [コマンド名]`  
    `lsof -c [コマンド名1] -c [コマンド名2]`
  - 除外するコマンド名（プロセス名）指定して、開いているファイル・ポートを表示  
    `lsof -c [コマンド名] -c ^[除外するコマンド名]`
  - プロセスIDを指定して、開いているファイル・ポートを表示  
    `lsof -p [プロセスID]`
  - ユーザ名を指定して、開いているファイル・ポートを表示  
    `lsof -u [ユーザ名]`
  - lsofコマンドの表示内容
    - COMMAND  
      実行されているコマンド 
    - PID  
      プロセスID
    - TID  
      スレッドID
    - USER  
      ユーザ名
    - FD  
      ファイルディスクリプタ
        - cwd  
          カレンドディレクトリ
        - txt  
          テキストファイル
        - mem  
          メモリマッピングファイル
        - mmap  
          メモリマッピングデバイス
        - [n]u  
          ファイルディスクリプタ番号＋読み書き
        - [n]r  
          ファイルディスクリプタ番号＋読み取り
        - [n]w  
          ファイルディスクリプタ番号＋書き込み
    - TYPE  
      タイプ
        - REG  
          通常ファイル
        - DIR  
          ディレクトリ
        - FIFO  
          FIFO
        - CHR  
          デバイスファイル
        - unix  
          UNIXドメインソケット
        - IPv4  
          IPv4ソケット
        - IPv6  
          IPv6ソケット
    - DEVICE  
      デバイス
    - SIZE/OFF  
      ファイルサイズ
    - NODE  
      プロトコル
    - NAME  
      ファイルまたはポート
  - 検索条件を or から and にする  
    `lsof +D /var -u root -a`
  - リフレッシュ秒を指定（デフォルトは15秒）  
    `lsof -c node -r1`

